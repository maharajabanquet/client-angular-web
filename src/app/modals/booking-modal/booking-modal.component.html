
<mat-spinner *ngIf="!formReadyToLoad" style="margin:0 auto;" mode="indeterminate"></mat-spinner>
  <p *ngIf="showStatusFlag" [ngStyle]="{color: currentStatus.color,  'font-weight': 'bold', 'font-size': '20px'}">      <button (click)="sendWhatsApp()" mat-mini-fab color="accent" aria-label="Example icon button with a plus one icon">
    <mat-icon>notification_important</mat-icon>
  </button>  &nbsp;{{currentStatus.label}}<p>

    <form *ngIf="formReadyToLoad" [formGroup]="bookingForm" class="example-form">
    
        <mat-form-field color="accent" appearance="outline">
            <mat-label>Booking Date</mat-label>
            <input formControlName="bookingDate"  matInput >
            <mat-icon matSuffix>date_range</mat-icon>
          </mat-form-field>
      
        <table class="example-full-width" cellspacing="0"><tr>
          <td>
            <mat-form-field color="accent" appearance="outline">
                <mat-label>First Name</mat-label>
                <input formControlName="firstName"  matInput placeholder="Enter First Name">
                <mat-icon matSuffix>person</mat-icon>
                <mat-error *ngIf="checkError('firstName', 'required')">First Name is required</mat-error>
                <mat-error *ngIf="checkError('firstName', 'minlength')">First Name should be more than 2 characters</mat-error>
                <mat-error *ngIf="checkError('firstName', 'maxlength')">First Name should be less than 20 characters</mat-error>
              </mat-form-field>
          </td>
          <td>
            <mat-form-field color="accent" appearance="outline">
                <mat-label>Last Name</mat-label>
                <input formControlName="lastName" matInput placeholder="Enter Last Name">
                <mat-icon matSuffix>person</mat-icon>
                <mat-error *ngIf="checkError('lastName', 'required')">Last Name is required</mat-error>
                <mat-error *ngIf="checkError('lastName', 'minlength')">Last Name should be more than 2 characters</mat-error>
                <mat-error *ngIf="checkError('lastName', 'maxlength')">Last Name should be less than 20 characters</mat-error>
              </mat-form-field>
          </td>
        </tr></table>
      
        <p>
            <mat-form-field color="accent" appearance="outline">
                <mat-label>Phone Number</mat-label>
                <input formControlName="phoneNumber" matInput placeholder="Enter Phone Number">
                <mat-icon matSuffix>phone</mat-icon>
                <mat-error *ngIf="checkError('phoneNumber', 'required')">Phone Number is required</mat-error>
                <mat-error *ngIf="checkError('phoneNumber', 'pattern')">Inavlid Phone Number</mat-error>
              </mat-form-field>
       
        </p>
        <table class="example-full-width" cellspacing="0"><tr>
          <td>
            <mat-form-field style="width: 450px;" appearance="outline">
                <mat-label>Address</mat-label>
                <textarea formControlName="address"  matInput placeholder="Enter Customer Address"></textarea>
                <mat-error *ngIf="checkError('address', 'required')">Address is required</mat-error>
                <mat-error *ngIf="checkError('address', 'minlength')">Address should be more than 50 characters</mat-error>
                <mat-error *ngIf="checkError('address', 'maxlength')">Address should be less than 5 characters</mat-error>
              </mat-form-field>
          </td>
        </tr></table>
        <table class="example-full-width" cellspacing="0"><tr>
          <td>
            <mat-form-field appearance="outline">
              <mat-label>Requirements</mat-label>
              <mat-select  formControlName="requirements">
                <mat-option *ngFor="let item of requirements" [value]="item">{{item}}</mat-option>
              </mat-select>
              <mat-error *ngIf="checkError('requirements', 'required')">Requirements is required</mat-error>
            </mat-form-field>
          </td>
        
            <!-- <td>
                <mat-form-field *ngIf="!formDisabled" appearance="outline">
                    <mat-label>Requirements</mat-label>
                    <mat-select  formControlName="requirements">
                      <mat-option *ngFor="let item of requirements" [value]="item">{{item}}</mat-option>
                    </mat-select>
                    <mat-error *ngIf="checkError('requirements', 'required')">Requirements is required</mat-error>
                  </mat-form-field>
                  &nbsp;
                  <ng-container *ngIf="bookingForm.get('requirements')?.value === 'Engagement' || bookingForm.get('requirements')?.value === 'Birthday Party' || bookingForm.get('requirements')?.value === 'Others'">
                    <mat-form-field *ngIf="!formDisabled " appearance="outline">
                      <mat-label>Facilites</mat-label>
                      <mat-select  formControlName="facilities" multiple>
                        <mat-option *ngFor="let item of facilites" [value]="item">{{item.label}}</mat-option>
                      </mat-select>
                      <mat-error *ngIf="checkError('facilities', 'required')">Facilites is required</mat-error>
                    </mat-form-field>
                  </ng-container>

                 <div *ngIf="formDisabled"> -->
                  <!-- <table mat-table [dataSource]="dataSource" class="mat-elevation-z8">
                  
                    <ng-container matColumnDef="position">
                      <th mat-header-cell *matHeaderCellDef>Sl.No </th>
                      <td mat-cell *matCellDef="let element"> {{element.position}} </td>
                    </ng-container>
                  
                    <ng-container matColumnDef="facilities">
                      <th mat-header-cell *matHeaderCellDef> Facilites </th>
                      <td mat-cell *matCellDef="let element"> {{element.facilities}} </td>
                    </ng-container>
                    <ng-container matColumnDef="price">
                      <th mat-header-cell *matHeaderCellDef> Price </th>
                      <td mat-cell *matCellDef="let element"> {{element.price}} </td>
                    </ng-container>
                    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                    <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
                  </table>
               -->
                 <!-- </div> -->
               
            <!-- </td> -->
          </tr></table>
          <table class="example-full-width" cellspacing="0">
            <tr>
              <td>
                <mat-checkbox  class="example-margin" formControlName="dgWithDiesel" >DG WITH DIESEL</mat-checkbox>
              </td>
            </tr>
            <tr>
              <td>
                <mat-checkbox  class="example-margin" formControlName="DJ" >DJ</mat-checkbox>
              </td>
            </tr>
            <tr>
              <td *ngIf="showDjAssigned">
                <mat-form-field  appearance="outline" >
                  <mat-label>Assign DJ</mat-label>
                  <mat-select  formControlName="assignedDj">
                    <mat-option *ngFor="let dj of djUser" [value]="dj.mobile">{{dj.userName}}</mat-option>
                  </mat-select>
                </mat-form-field>
              </td>
              <td *ngIf="showDjAssigned">
                <mat-form-field  appearance="outline" >
                  <mat-label>DJ Type</mat-label>
                  <mat-select  formControlName="djType">
                    <mat-option value="Basic">Basic</mat-option>
                    <mat-option value="Intermediate">Intermediate</mat-option>
                    <mat-option value="Advance">Advance</mat-option>
                  </mat-select>
                </mat-form-field>
              </td>
            </tr>
          </table>
          <br>
        <table class="example-full-width" cellspacing="0"><tr>
            <td>
                <mat-form-field color="accent" appearance="outline">
                    <mat-label>Advance</mat-label>
                    <input  (keyup)="onInputBalanceAmount($event)" formControlName="BookingAmount" matInput placeholder="Enter Booking Amount">
                    <mat-icon matSuffix>money</mat-icon>
                    <mat-error *ngIf="checkError('address', 'required')">Booking Amount is required</mat-error>
                  </mat-form-field>
            </td>&nbsp;
            <td>
                <mat-form-field color="accent" appearance="outline">
                    <mat-label>Deal Amount</mat-label>
                    <input  formControlName="finalAmount"  matInput placeholder="Enter Final Amount">
                    <mat-error *ngIf="checkError('address', 'required')">Final Amount is required</mat-error>
                    <mat-icon matSuffix>money</mat-icon>
                  </mat-form-field>
            </td>
          </tr></table>
          <table>
            <tr>
              <td>
                <mat-form-field color="accent" appearance="outline">
                  <mat-label>Balanced Due</mat-label>
                  <input style="font-weight: bold;" formControlName="balancedAmount"  matInput>
                  <mat-icon matSuffix>money</mat-icon>
                </mat-form-field>
              </td>
            </tr>
          </table>
          <p>
            <div >
                <input  type="file" style="display: none" #fileInput accept="*" (change)="onChangeFileInput($event)" />
                <button mat-raised-button color="primary" class="file-select-button" (click)="onClickFileInputButton()">
                  <mat-icon>attach_file</mat-icon>
                 Upload Proof
                </button>
              
                <p class="file-name" *ngIf="!file; else fileName"></p>
                <ng-template #fileName>
                  <p *ngIf="bookingForm.get('expense_sheet')?.value === ''" class="file-name">{{ file?.name }}</p>
                  <p style="color:green;" *ngIf="fileuploaded">File Has Been Uploaded</p>
                </ng-template>
                <br>
             
              </div>
           <p>
            
          <button  mat-stroked-button style="color:red" (click)="closeModal()">Cancel</button>&nbsp;
          <button *ngIf="!printReady"  mat-stroked-button style="color:green" [disabled]="bookingForm?.status === 'INVALID'" (click)="submit()">Submit</button>&nbsp;
       <ng-container *ngIf="!invoice_generated">
         <button *ngIf="printReady"  mat-stroked-button   (click)="givePrint()"> 
           <mat-icon>print</mat-icon>&nbsp;Print
         </button>&nbsp;
         <button *ngIf="printReady"  mat-stroked-button   (click)="edit()"> 
          Edit
        </button> &nbsp;
        <button *ngIf="printReady && isUpdate"  mat-stroked-button style="font-weight: bold;"  mat-stroked-button   (click)="update()"> 
          Update
        </button>&nbsp;
        <button *ngIf="printReady"  mat-stroked-button style="font-weight: bold;"  mat-stroked-button   (click)="deleteBooking()"> 
          Delete
        </button>&nbsp;
         <mat-spinner *ngIf="showLoader" [diameter]="30" style="margin-left:194px;margin-top:-36px;"></mat-spinner>
       </ng-container>&nbsp;

          <ng-container *ngIf="bookingForm.get('expense_sheet')?.value">
         <button *ngIf="printReady"  mat-stroked-button   (click)="downloadExpenseSheet()"> 
           <mat-icon>cloud_download</mat-icon>&nbsp;Download Expense Sheet
         </button>
       </ng-container>
       <ng-container *ngIf="invoice_generated">
        <button *ngIf="!settled"  mat-stroked-button style="font-weight: bold;" (click)="openDialog()">Settle</button>&nbsp;
        <button *ngIf="printReady"  mat-stroked-button style="font-weight: bold;"  mat-stroked-button   (click)="edit()"> 
          Edit
        </button>&nbsp;
        <button *ngIf="printReady && isUpdate"  mat-stroked-button style="font-weight: bold;"  mat-stroked-button   (click)="update()"> 
          Update
        </button>&nbsp;
        <button *ngIf="printReady"  mat-stroked-button style="font-weight: bold;"  mat-stroked-button   (click)="deleteBooking()"> 
          Delete
        </button>&nbsp;
        <mat-label style="color:green;font-weight: bold;">Invoice Generated</mat-label>
       </ng-container>
       <ng-container>
       
       </ng-container>
      </form>
      